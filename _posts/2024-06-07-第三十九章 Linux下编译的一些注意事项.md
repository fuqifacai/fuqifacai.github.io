---
layout:       post
title:        "第三十九章 Linux下编译的一些注意事项"
author:       "Ramendeus"
header-style: text
catalog:      true
tags:
    - 流式
    - WebRTC
    - Streaming
---

[访问 2img.ai 官网以获取更多AI/AIGC信息](https://2img.ai)
[访问 个人技术博客: fuqifai.github.io](https://fuqifai.github.io)

本文大部分配图使用微信小程序【字形绘梦】免费生成。
![](/img/小程序码.png)

AIGC技术讨论群
![](/img/RA群永久二维码.png)

## 第三十九章 Linux下编译的一些注意事项


## 如何抽取头文件作为SDK

很多情况下我们编译完成WebRTC后，需要直接将Lib和头文件以一种比较好的目录结构形式给外部程序调用，而默认的WebRTC的编译系统将目标文件输出在了WebRTC源代码目录中，相对来说不是很直观和方便。

我们通过使用下面的脚本，一键抽取头文件和Lib文件，形成类似SDK一样的包。方便外部程序使用。

##注意

1 在Linux下生成头文件的抽取 使用脚本 GenerateSDK.sh .放在src目录下

2 需要在src平级目录创建linux-include 目录，用于存放生成后的内容

3 执行./GenerateSDK.sh

文件内容

```
#!/bin/bash
  src=`find ./ -name "*.h*"`
  echo $src
for obj in $src
do      echo "cp header file $obj"      cp --parents $obj ../linux-include/
  done
```

## 禁止X 窗体系统的编译

在编译webrtc的时候是可以选择不编译XWindows系统的。

这样的话，对应的一些能力也将不具备。比如内置的针对窗口的捕获器等源代码都将不会被编译和LINK进来，最终代码调用的时候，即便你手动引用对应的头文件，但是在库文件中还是找不到符号而发生LINK错误。

这个问题尤其要重视。

## 针对Glibc库的依赖和更新错误问题

有可能在某些Glibc版本不确定的Linux系统上，运行提示错误，需要更新Glibc库，但是由于这个库对于系统来说比较重要，并且非常容易更新失败，因此不建议轻易全局升级。建议Install后，采用单个直接引用LD\_LIBRARY\_PATH的方式指定具体需要依赖的.so ，避免写入全局PATH环境，造成整个Shell无法运行，甚至整个Linux系统无法启动使用。

### **潜在风险和问题**

1.  **依赖问题**

+   **依赖版本不兼容**：不同版本的依赖库可能导致编译失败或运行时错误。确保所有依赖的版本与 WebRTC 的要求兼容。
+   **缺少依赖**：某些依赖可能没有安装或配置不正确，导致编译过程中出现问题。可以查看编译文档或错误日志来识别和安装缺失的依赖。

2.  **编译配置错误**

+   **配置参数不正确**：错误的配置参数可能导致编译失败或生成的二进制文件不符合预期。确保 `gn` 或 `cmake` 配置正确，并符合 WebRTC 的要求。
+   **编译选项问题**：编译选项不正确可能导致性能问题或功能不完整。确保使用适当的编译选项来满足项目需求。

3.  **兼容性问题**

+   **不同平台间的兼容性**：WebRTC 的编译和运行可能在不同的 Linux 发行版或版本上表现不同。确保在目标平台上测试编译后的二进制文件，以验证兼容性。
+   **第三方库的兼容性**：WebRTC 可能依赖于某些第三方库，这些库的版本或实现可能在不同的系统上存在差异。

4.  **安全和稳定性**

+   **安全漏洞**：编译后的代码可能包含未修复的安全漏洞。确保使用最新版本的 WebRTC 和依赖库，并定期检查安全更新。
+   **稳定性问题**：在编译和测试过程中，可能会发现稳定性问题。使用不同的测试用例和负载条件来验证代码的稳定性和可靠性。

5.  **构建工具问题**

+   **工具版本**：确保 `gn`、`ninja` 和其他构建工具的版本与 WebRTC 的要求一致。不同版本的构建工具可能会导致不兼容的问题。

### **总结**

在 Linux 下编译 WebRTC 需要仔细配置和管理各种依赖、工具和参数。遵循编译过程中的最佳实践，注意潜在的风险和问题，可以确保成功编译和运行 WebRTC 应用。定期更新和维护编译环境，进行充分的测试和验证，能够帮助确保 WebRTC 项目的稳定性和可靠性。
